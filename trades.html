<!DOCTYPE html>
<meta charset="utf-8">
<style>

circle.node {
  stroke: #fff;
  stroke-width: 1.5px;
}

line.link {
  stroke: #999;
  stroke-opacity: .6;
}

.nodetext {pointer-events: none; font-size: 50%}

</style>
<head>
			<!-- <link href='https://fonts.googleapis.com/css?family=Ruda:400,700|Cantarell:400,700,400italic,700italic' rel='stylesheet' type='text/css'> -->
			<!-- <link href='https://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'> -->
      	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
			<meta charset="utf-8">
			<meta name="viewport" content="width=device-width, initial-scale=1"/>
			<meta name="keywords" content="maps,cartography, hazardous waste trade"/>
			<title>Waste Trade Network</title>

			<!--put Bootstrap stylesheet links above style.css-->
			<link rel="stylesheet" href="CSS/bootstrap.min.css">
			<link rel="stylesheet" href="CSS/bootstrap-theme.min.css">
			<link rel="stylesheet" href="CSS/style.css">
			<script type="text/javascript" src="lib/jquery-1.11.3.min.js"></script>
			<script type="text/javascript" src="lib/bootstrap.min.js"></script>
			<script type="text/javascript" src="lib/d3.js" charset="utf-8"></script>
			<script type="text/javascript" src="lib/queue.js"></script>
			<script type="text/javascript" src="lib/topojson.v1.min.js"></script>
			<script type="text/javascript" src="lib/tip.js"></scrip<script src="lib/w3HTMLinclude.js"></script>
			<script src="lib/w3HTMLinclude.js"></script>

	</head>

	<body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87476640-1', 'auto');
  ga('send', 'pageview');

</script>	<div w3-include-html="nav.html"></div>
	<script>
	w3IncludeHTML();
	</script>

	<div class="center">
		<div class="jumbotron">
				<div class="container">
						<h1>Who Trades with Whom?</h1>
				</div>
		</div>
	</div>

		<div class="container">
			<div class="col-md-8 col-md-offset-2" id="trades-image">
				<script>
					var graph;
					var vis;
					var tooltip = d3.tip()
					  .attr('class', 'd3-tip')
					  .offset([-5, 0])
					  .html(function(d) {
					    return "<span style='color:white'>" + d.source.name + " sent "+ d.value + " shipments to "+ d.target.name +"</span>";
					  })

					var h = window.innerHeight/2,
						w = $(".col-md-8").width(),
					    fill = d3.scale.category20();

					vis = d3.select(".col-md-8")
					  .append("svg:svg")
					    .attr("width", w)
					    .attr("id","old")
					    .attr("height", h)
					    .attr("pointer-events", "all")
					  .append('svg:g')
					    .call(d3.behavior.zoom().on("zoom", redraw))
					  .append('svg:g');

					  vis.append('svg:rect')
					    .attr('width', w)
					    .attr('height', h)
					    .attr('fill', 'white');

					vis.call(tooltip)

					function redraw() {
					  //console.log("here", d3.event.translate, d3.event.scale);
					  vis.attr("transform",
					      "translate(" + d3.event.translate + ")"
					      + " scale(" + d3.event.scale + ")");
					}


					var file="data/trades.json";


					d3.json(file, function(json) {

					  var force = d3.layout.force()
					      .charge(-75)
					      .linkDistance(75)
					      .nodes(json.nodes)
					      .links(json.links)
					      .size([w, h])
					      .start();

					  var link = vis.selectAll("line.link")
					      .data(json.links)
					    .enter().append("svg:line")
					      .attr("class", "link")
					      .style("stroke-width", function(d) { return Math.sqrt(d.value); })
					      .attr("x1", function(d) { return d.source.x; })
					      .attr("y1", function(d) { return d.source.y; })
					      .attr("x2", function(d) { return d.target.x; })
					      .attr("y2", function(d) { return d.target.y; })
					      .on("mouseover", function(d){tooltip.show(d)})
					      .on('mouseout', function(d){tooltip.hide(d)})

					  var node = vis.selectAll("g.node")
					      .data(json.nodes)
					    .enter().append("svg:g")
					      .attr("class", "node")

					  	node.append("svg:circle")
					      .attr("r", 5)
					      .style("fill", function(d) { return fill(d.group); })
					      .call(force.drag)

					  node.append("svg:text")
					    .attr("class", "nodetext")
					    .attr("dx", 4)
						  .attr("dy", ".35em")
						.text(function(d) { return d.name; })


					  node.append("svg:title")
					    .text(function(d) { return d.name; })
					    .attr("class","legendText")

					  vis.style("opacity", 1e-6)
					    .transition()
					      .duration(1000)
					      .style("opacity", 1);

					  force.on("tick", function() {
					    link.attr("x1", function(d) { return d.source.x; })
					        .attr("y1", function(d) { return d.source.y; })
					        .attr("x2", function(d) { return d.target.x; })
					        .attr("y2", function(d) { return d.target.y; });

					    node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

					  graph = json;
					  });

					});

				function filter() {
					/*   svg.selectAll('circle')
					    .filter(function (d){return d.namer.indexOf("CLEAN HARBOR") == -1}) // >-1
					    .style("fill", "blue")
					    //.remove()
					*/
					}

				</script>
			</div>
		</div>
		<div class="container">
			<div class="col-md-12" id = "bodyText"><h4>Network Analysis of Hazardous Waste Shipments, 2007-2012</h4>
				<h5>This force-directed graph shows the companies involved in the hazardous waste trade found in our dataset. Companies that trade with one another are clustered together, with unrelated companies located farther from the respective cluster. There are large clusters around Clean Harbors, Veolia, U.S. Ecology, and World Resources Company. These companies were identified as key companies in the hazardous waste trade, with <a href="http://uwcart.github.io/waste/clean-harbors-shipments.html">Clean Harbors</a> being the most involved.
				</h5>
			<br>
			</div>
		</div>
    <footer class="footer">
  		<!-- <div class="container"> -->
  			<div class="logos">
  			<a href = "http://geography.wisc.edu" target="blank"><img src="img/uwgeog-01.png" alt="UW Geography Logo" hspace="10"></a>
  			<a href = "https://www.nsf.gov/" target="blank"><img src="img/nsf-01-01.png" alt="NSF Logo" hspace="10"></a>
  			<a href = "http://www.geography.wisc.edu/cartography/" target="blank"><img src="img/uwcart-01-01.png" alt="uwcart Logo" hspace="10"></a>
  			</div>
  		<!-- </div> -->
  	</footer>

	</body>


</html>
